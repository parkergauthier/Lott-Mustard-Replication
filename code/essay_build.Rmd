---
title: "Untitled"
author: "Parker Gauthier"
date: "4/15/2022"
output: md
---

# Lott and Mustard Replication Excercise

## Introduction

  For years the relationship between crime and gun laws has been a topic of significant contention in the United States. Some argue that restricting gun ownership will deter gun violence, while those on the other end of the aisle believe in quite the opposite. Researchers John Lott and David Mustard aimed to clear up this argument in their paper, "Crime, Deterrence, and Right-to-Carry Concealed Handguns."  The authors attempt to tackle this problem by analyzing the effects of concealed carry laws on various crime rates using econometric models aimed at inferring causality.  The authors conclude that when states give their citizens the right to carry a concealed firearm, violent crime rates decline without a significant increase in accidental gun deaths.  Their findings are quite intriguing, but were their methods sound?
```
```
  The goal of the analysis below will be to assess the models used by Lott and Mustard and see how they stack up to contemporary causal inference methods.  We will look at the same data used by the researchers and first attempt to replicate their results.  We will then used other predictive models to see if we see the same effects depicted by the researchers.  Ultimately, we will assess what methods are the most effective in determining causal effects and highlight the implications of using a faulty model.
  
## Background and Economic Theory



```{r include=FALSE}

#loading packages

if (!("librarian" %in% rownames(utils::installed.packages()))) {
  utils::install.packages("librarian")
}

librarian::shelf( 
  cran_repo = "https://cran.microsoft.com/",
  ask = FALSE,
  stats, 
  here,
  kableExtra,
  ggthemes,
  tidyverse,
  lubridate,
  haven,
  lmtest,
  gganimate,
  gapminder,
  stargazer,
  snakecase,
  mosaic,
  dplyr,
  esquisse,
  plotly,
  modelr,
  rsample,
  caret,
  foreach,
  parallel,
  gamlr,
  glmnet,
  rpart,
  rpart.plot,
  rsample,
  randomForest,
  gbm,
  pdp,
  ggmap,
  devtools,
)

here::i_am("code/include.R")
```


```{r include=FALSE}
#Reading in the data

Lott = read_dta(here("data/UpdatedStateLevelData-2010.dta"))

```


```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE}
# Table showing rollout

# making data frame for states with year treated
treat_table =  Lott %>%
  select(state, shalll, year) %>%
  group_by(state) %>% 
  filter(shalll == 1) %>%
  summarise(treatment_year = min(year)) %>% 
  mutate(treatment_year = ifelse(treatment_year < 1977, yes = "Treated Entire Period", no = treatment_year), order = ifelse(treatment_year == "Treated Entire Period", yes = 1, no = treatment_year)) %>%  
  arrange(order) %>% 
  select(-order)


knitr::kable(treat_table, col.names = c("State Name", "Year Treated"), caption = "Table 1")
```


## Data

```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE}

# Table with summary statistics

Lott_select = Lott %>% 
  select(state, year, aovio, aopro, aomur, aorap, aorob, aobur, aolar, aoaut, ratmur, ratrap, rataga, ratrob, rataut, ratbur, ratlar)

namies = c("Arest Rates - Violent Crime", "Property Crime", "Murder", "Rape", "Robbery", "Burglary", "Larceny", "Auto Theft", "Crime Rates - Murder", "Rape", "Agravated Assault", "Robbery","Auto Theft", "Burglary", "Larceny")

sum_tab_sd = Lott_select %>% 
  select(year, aovio, aopro, aomur, aorap, aorob, aobur, aolar, aoaut, ratmur, ratrap, rataga, ratrob, rataut, ratbur, ratlar) %>%
  filter(year >= 1977 & year <= 1992) %>% 
  select(-year) %>% 
  summarise_all(sd, na.rm = TRUE) %>%
  round(2) %>% 
  t()

sum_tab_mean = Lott_select %>% 
  select(year, aovio, aopro, aomur, aorap, aorob, aobur, aolar, aoaut, ratmur, ratrap, rataga, ratrob, rataut, ratbur, ratlar) %>%
  filter(year >= 1977 & year <= 1992) %>% 
  select(-year) %>% 
  summarise_all(mean, na.rm = TRUE) %>% 
  round(2) %>% 
  t() %>% 
  cbind(sum_tab_sd)

sum_tab_sum = Lott_select %>% 
  select(year, aovio, aopro, aomur, aorap, aorob, aobur, aolar, aoaut, ratmur, ratrap, rataga, ratrob, rataut, ratbur, ratlar) %>%
  filter(year >= 1977 & year <= 1992) %>% 
  select(-year) %>% 
  summarise_all(sum, na.rm = TRUE) %>%
  round(0) %>% 
  t() %>% 
  cbind(sum_tab_mean)

row.names(sum_tab_sum) = namies

kable(sum_tab_sum, col.names = c("N", "Mean", "Sd"), caption = "Summary Statistics")
```

## Empircal Model and Estimation

```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE}




```
